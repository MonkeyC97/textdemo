

# 							  说明书



#基于单片机的自动节水灌溉系统



## 技术领域

​	本使用新型属于自动检测控制技术领域，具体涉及一种基于单片机的自动节水灌溉系统。



## 背景技术

​	传统的灌溉模式自动化程度低，属粗放的人工操作，即便给予定量，在操作中也无法进行有效的控制，为了提高灌溉效率，缩短劳动时间和节约水资源，必须发展节水自动灌溉技术。本课题旨在设计一套能对农作物生长的土壤湿度进行监控，并且自动灌溉的系统，它能对农作物进行适时，适量的灌溉，起到节水，节能，高效灌溉的作用。



### 实用新型内容

​	本文主要讨论单片机控制的节水灌溉系统，分别对土壤湿度与灌水量之间的关系、灌溉控制技术及系统设备硬件各个部分进行了探讨。



​	主要内容如下：

​	(1) 节水灌溉控制系统的整体说明与设计思路分析。

​	(2) 单片机的各部件的硬件说明，电路分析。

​	(3) 据土壤湿度值，在关税期间以预定的时间进行灌溉。当土壤湿度值低于设定的最低值时，系统便自动灌溉。

​	(4) 相对于落后的人工灌溉来讲，这种自动化的方式可以控制浇水量的多少，减少人工操作，达到节水的目的。

​	要实现智能灌溉，系统需要有单片机、传感器、A/D模块，电动机、电磁阀、管网和喷头等设备。



​	单片机：负责发出和接收各种运动程序指令，是整个控制系统的中枢部分。

​	传感器：用过湿度传感器采集土壤里的湿度信号，判断是否需要灌溉。

​	A/D模块：将传感器采集的信号送到单片机。

​	电动机：从水源抽水，为喷灌系统提供一定的压力。

​	电磁阀：控制喷头的喷灌与否。

​	喷头：实现均匀喷洒，便于充分吸收。

​	管网：灌溉系统输送水的管路。



##### 本实用新型所采用的技术方案包括：

​		单片机主系统电路、时钟电路、数据储存器的扩展电路、数据采集处理电路、4LED显示电路。







## 智能灌溉系统

### 1.组成

​	要实现智能灌溉系统，需要单片机，传感器，A/D模块，电动机，电磁阀，管网和喷头等设备。



### 2.系统结构框图

![屏幕快照 2019-06-16 下午4.16.49](/Users/houchang/Desktop/屏幕快照 2019-06-16 下午4.16.49.png)

​														图  2-1

### 3.系统的工作原理

	##### 1. 系统原理框图

​	(1)	湿度传感器采集到湿度信息，通过变换器，转化为电信号，A/D转换器将模拟电信号转化为离散信号，传给单片机。

​	(2)	单片机软件系统根据实现的设定值对采集的信息进行处理，输出离散的控制信号。

​	(3)	D/A转换器将离散的控制信号转化为模拟电量。通过模拟电量来控制阀门的动作，从而实现自动控制。



系统原理框图如图所示：

![QQ20190616-0](/Users/houchang/Desktop/QQ20190616-0.png)

​											 								图 3-1



​	(4)	通过湿度传感器采集湿度信息，经放大器放大后送到A/D转换器。A/D转换器将连续的模拟量转化为单片机能接受的离散的数字量。单片机收到流量信号后，在控制系统软件的作用下，发出相应的执行命令给进电机。进行控制。



##### 2.单片机主系统电路

​	AT89C51内部自带2K字节可编程FLASH储存器的低电压以及高性能COMS八位微处理器，与Intel MCS-51系列单片机的指令和输出管脚兼容。由于将多功能八位CPU和闪存储存器结合在单个芯片中所以AT89C51构成的单片机系统具有结构简单、造假低廉、效率高的特点，省去了外部的RAM、ROM和接口器件，减少了硬件开销，节省了成本，提高了系统的性价比，AT89C51片内共有512字节的用户数据区，而256字节的内部扩展数据区需通过清SFR（8EH）的位1并用MOVX指令访问，片内置通用8位中央处理器和FLASH储存单元，另一个256字节RAM区和ATMEL之AT89系列8052兼容的单片机是一致的，AT89C51RC结合通用的8位微处理器和FLASH储存集合构成功能强大单片微处理器，可提供许多高性能低价位的系统控制应用场所。



​	 ![控制电路](/Users/houchang/Downloads/控制电路.png)

​												       	 图 3-2 

​		（1）CPU的P0口是地址数据复用总线，由锁存器373存低8位地址，经译码器译码产生地址位F0H的输出信号作为ADC0809的选通信号

​		（2）从传感器送来的模拟信号经ADC0809转换为数字信号，对F0H地址的写操作启动A/D转换，然后查询EOC结束信号，直到EOC输出高电平表示A/D转换结束

​		（3）CPU通过对F0H地址的读操作读取转换结果，CPU经过数据处理后发出控制命令给电机系统，控制发动点击系统抽水打开阀门进行灌溉，传感器不断传送土壤的湿度值给单片机

​		（4）当土壤湿度值达到了预定设的湿度指数，发出信号关闭阀门停止灌溉。

​		（5）传感器每隔一定时间便给单片机传送土壤湿度值，一旦为达到预设的湿度，不合适农作物生长的条件下，主机系统便开始循环自动灌溉。



##### 3.时钟电路

![屏幕快照 2019-06-16 下午7.34.52](/Users/houchang/Desktop/屏幕快照 2019-06-16 下午7.34.52.png)

​		单片机的时钟信号用来提供单片机片内各种微操时间基准，时钟信号通常有两种电路形式：内部振荡和外部振荡。如图3-3所示在其外界警惕振荡器或陶瓷谐振器就构成了内部震荡方式，片内高增益反向放大器与作为反馈元件的片外石英晶体或陶瓷谐振器一起构成一个自己振荡器并产生震荡时钟脉冲。

​		外接晶体以及电容c2和c1构成并联谐振电路，他们起稳定频率，快速起振的作用，其值均为30P左右，晶振频率选6MHz。



##### 4.数据储存器的扩展电路

​		AT89C51单片机外接数据RAM时，P2口输出存储器地址的高8位，P0口分时输出地址的低8位和传送指令字节或数据。P0口先输出低8位地址信号，在ALE有效时将它锁存到外部地址锁存器中，然后P0口作为数据总线使用，地址锁存器选用74LS373. 单片机的系统存储器结构及存储器的编制方法：

![屏幕快照 2019-06-16 下午7.41.53](/Users/houchang/Desktop/屏幕快照 2019-06-16 下午7.41.53.png)

##### 5.数据采集处理电路



![屏幕快照 2019-06-16 下午8.11.15](/Users/houchang/Desktop/屏幕快照 2019-06-16 下午8.11.15.png)

​	

​	ADC0809是一种8位逐次逼近式A/D转换器，内部具有锁存控制的8路模拟开关，外接8路模拟输入端，可同时对8路0-5V的输入模拟电压信号分时进行采集转换。本系统只用到IN0和IN1两路输入通道。ADC0809转换器的分辨率为8位。A/D转换器需外部控制启动转换信号方能进行转换，这一启动转换信号方能进行转换，这一启动转换信号可以由CPU体统，不同型号的A/D转换器，对启动转换信号的要求也不同，分脉冲启动和电平启动两种，ADC0809采用脉冲启动转换，只需给A/D转换器的启动控制转换的输入引脚(START)上，加入正脉冲信号，即启动A/D转换器进行转换，转换开始后，转换接收信号输出端（EOC）信号变低，转换结束时，EOC返回高电平，以通知主机读取转换结果的数字量，这个信号可以做为A/D转换器的状态信号供查询，也可以用作中断请求信号，本系统中ADC0809与AT89C51单片机的接口如图3-2所示，采用等待延时方式。

##### 6. 4LED显示系统电路

![屏幕快照 2019-06-16 下午7.55.55](/Users/houchang/Desktop/屏幕快照 2019-06-16 下午7.55.55.png)

​																		图 6-6

​		微机化测控系统中常用的测量数据的显示器有发光二极管显示器(简称LED或数码管)和液晶显示器(LCD)。这两种显示器都具有线路简单、耗电少、成本低、寿命长等优点，本系统输出结果选用4个LED显示。数码管有共阴共阳之分，本系统采用8段共阴型LED，其原理图如图6-6所示。

​		每位数码管内部有8个发光二极管，公共端由8个发光二极管的阴极并接而成，正常显示时公共端接低电平(GND)，各发光二极管是否点亮取决于a-dp各引脚上是否是高电平。

​		LED数码管的外形结构如图6，外部有10个引脚，其中3，8脚位公共端也称为选端，其余8个引脚被称为段选端，当要使某一位数码管显示某一数字(0-9种的一个)必须在这个数据管的段选端加上与数字显示数字对应的8位段选码(也称字形码)，在位选端加上低电平即可。

​		由于系统要显示的内容比较简单，显示量不多，所以选用数码管既方便又经济。

​		二极管的阴极链接在一起，通常此公共阴极接低，而共阳极则将发光二极管的阳极链接在一起，接入+5V的电压。一位显示器由8个发光二极管组成，其中7个发光二极管构成字形"8"，a-g，另一个小数点位dp发光二极管。当在某段发光二极管是假一定的正向电压时，该段笔划即亮；不加电压则暗。为了保护各段LED不被损坏，需外加限流电阻。



















